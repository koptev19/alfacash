<?php

namespace App\Sources;

use App\Contracts\ExchangeSourceContract;

class ExchangeTest implements ExchangeSourceContract
{
    /**
     * @var array
     */
    private $markets = [
        'ETH/BTC' => [  //0.5
            'bids' => [
                [0.48, 0.2],
                [0.47, 0.52],
                [0.465, 1.8],
                [0.457, 2.9],
                [0.452, 2.2],
            ],
            'asks' => [
                [0.511, 1.3],
                [0.512, 0.7],
                [0.521, 0.6],
                [0.528, 2.20],
                [0.537, 2.10],
            ]
        ],
        'LTC/BTC' => [  //0.8
            'bids' => [
                [0.79, 1.6],
                [0.778, 0.7],
                [0.759, 0.9],
                [0.734, 1.21],
                [0.725, 1.7],
            ],
            'asks' => [
                [0.815, 0.65],
                [0.823, 0.12],
                [0.845, 0.99],
                [0.856, 1.4],
                [0.871, 1.9],
            ]
        ],
        'BTC/USDT' => [ // 1000
            'bids' => [
                [962, 0.15],
                [951, 0.24],
                [945, 0.33],
                [932, 0.82],
                [915, 1.31],
            ],
            'asks' => [
                [1013, 0.05],
                [1027, 0.12],
                [1045, 0.29],
                [1078, 0.47],
                [1082, 1.23],
            ]
        ],
        'ETH/USDT' => [ // 500
            'bids' => [
                [493, 0.28],
                [481, 0.38],
                [476, 0.72],
                [465, 1.69],
                [459, 2.37],
            ],
            'asks' => [
                [512, 0.18],
                [526, 0.34],
                [529, 0.79],
                [539, 1.46],
                [547, 2.89],
            ]
        ],
        'ETC/ETH' => [  // 4
            'bids' => [
                [3.999, 1.5],
                [3.84, 3],
                [3.77, 4],
                [3.74, 2],
                [3.64, 1],
            ],
            'asks' => [
                [4.07, 1.5],
                [4.12, 3],
                [4.15, 4],
                [4.26, 2],
                [4.32, 1],
            ]
        ],
        'ETC/BTC' => [  // 2
            'bids' => [
                [1.97, 0.7],
                [1.95, 0.3],
                [1.90, 0.8],
                [1.87, 1.7],
                [1.84, 1.3],
            ],
            'asks' => [
                [2.03, 0.1],
                [2.11, 0.9],
                [2.13, 1.1],
                [2.16, 1.2],
                [2.19, 1.7],
            ]
        ],
        'XRP/BTC' => [  // 0.3
            'bids' => [
                [0.296, 1.1],
                [0.291, 1.4],
                [0.284, 1.3],
                [0.281, 2.4],
                [0.276, 2.8],
            ],
            'asks' => [
                [0.301, 1.1],
                [0.317, 1.8],
                [0.318, 1.4],
                [0.319, 2.4],
                [0.324, 2.8],
            ]
        ],
        'XRP/ETH' => [  // 0.6
            'bids' => [
                [0.587, 0.7],
                [0.574, 1.1],
                [0.571, 0.1],
                [0.561, 1.8],
                [0.558, 1.7],
            ],
            'asks' => [
                [0.607, 0.6],
                [0.609, 0.4],
                [0.613, 0.9],
                [0.627, 1.4],
                [0.639, 1.8],
            ]
        ],
        'LTC/ETH' => [  // 1.6
            'bids' => [
                [1.589, 0.5],
                [1.571, 1.1],
                [1.529, 0.9],
                [1.521, 1.4],
                [1.449, 1.5],
            ],
            'asks' => [
                [1.598, 0.9],
                [1.674, 1.4],
                [1.679, 0.7],
                [1.745, 0.4],
                [1.769, 1.8],
            ]
        ],
        'LTC/USDT' => [  // 800
            'bids' => [
                [789, 0.9],
                [765, 0.25],
                [751, 0.34],
                [742, 0.83],
                [733, 1.59],
            ],
            'asks' => [
                [815, 0.19],
                [822, 0.34],
                [846, 0.79],
                [851, 0.99],
                [877, 1.56],
            ]
        ],
        'XRP/USDT' => [  // 300
            'bids' => [
                [292, 0.48],
                [290, 0.86],
                [284, 2.54],
                [281, 1.93],
                [275, 3.82],
            ],
            'asks' => [
                [305, 0.41],
                [309, 0.91],
                [315, 1.64],
                [319, 2.34],
                [322, 3.33],
            ]
        ],
        'ETC/USDT' => [ // 2000
            'bids' => [
                [1970, 0.07],
                [1951, 0.42],
                [1904, 0.33],
                [1877, 0.89],
                [1841, 0.81],
            ],
            'asks' => [
                [2050, 0.05],
                [2110, 0.19],
                [2130, 0.24],
                [2160, 0.83],
                [2181, 0.47],
            ]
        ],
    ];

    /**
     * @return array
     */
    public function load_markets()
    {
        $markets = [];

        foreach($this->markets as $symbol => $prices) {
            $id = implode('', explode(config('exchange.currencies_separator'), $symbol));

            $markets[$symbol] = [
                'id' => $id,
                'lowercaseId' => strtolower($id),
                'symbol' => $symbol,
                'taker' => 0.001,
                'info' => [
                    'filters' => [
                        [
                            "filterType" => "LOT_SIZE",
                            "minQty" => 0.001,
                            "maxQty" => 1000.00000000,
                            "stepSize" => 0.001
                        ]
                    ]
                ]
            ];
        }

        return $markets;
    }

    /**
     * @param string $symbol
     * @param int|null $limit
     * @param array $params
     *
     * @return array
     */
    public function fetch_order_book(string $symbol, ?int $limit = null, array $params = [])
    {
        $prices = $this->markets[$symbol];
        $prices['symbol'] = $symbol;
        return $prices;
    }
}